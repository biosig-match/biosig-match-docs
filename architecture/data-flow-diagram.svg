<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 13.1.2 (20250808.2320)
 -->
<!-- Pages: 1 -->
<svg width="3068pt" height="852pt"
 viewBox="0.00 0.00 3068.00 852.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 847.5)">
<polygon fill="white" stroke="none" points="-4,4 -4,-847.5 3064.36,-847.5 3064.36,4 -4,4"/>
<text xml:space="preserve" text-anchor="middle" x="1530.18" y="-820.5" font-family="Times New Roman,serif" font-size="20.00">Interactive Data Flow Diagram</text>
<g id="clust1" class="cluster">
<title>cluster_0</title>
<path fill="#eeeeee" stroke="#eeeeee" d="M708.36,-151C708.36,-151 880.36,-151 880.36,-151 886.36,-151 892.36,-157 892.36,-163 892.36,-163 892.36,-462 892.36,-462 892.36,-468 886.36,-474 880.36,-474 880.36,-474 708.36,-474 708.36,-474 702.36,-474 696.36,-468 696.36,-462 696.36,-462 696.36,-163 696.36,-163 696.36,-157 702.36,-151 708.36,-151"/>
<text xml:space="preserve" text-anchor="middle" x="794.36" y="-454.8" font-family="Times New Roman,serif" font-size="16.00">External Actors</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_1</title>
<path fill="#eeeeee" stroke="#eeeeee" d="M2004.36,-8C2004.36,-8 2176.36,-8 2176.36,-8 2182.36,-8 2188.36,-14 2188.36,-20 2188.36,-20 2188.36,-125 2188.36,-125 2188.36,-131 2182.36,-137 2176.36,-137 2176.36,-137 2004.36,-137 2004.36,-137 1998.36,-137 1992.36,-131 1992.36,-125 1992.36,-125 1992.36,-20 1992.36,-20 1992.36,-14 1998.36,-8 2004.36,-8"/>
<text xml:space="preserve" text-anchor="middle" x="2090.36" y="-117.8" font-family="Times New Roman,serif" font-size="16.00">External Services</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_2</title>
<path fill="#eeeeee" stroke="#eeeeee" d="M1140.36,-214C1140.36,-214 1312.36,-214 1312.36,-214 1318.36,-214 1324.36,-220 1324.36,-226 1324.36,-226 1324.36,-331 1324.36,-331 1324.36,-337 1318.36,-343 1312.36,-343 1312.36,-343 1140.36,-343 1140.36,-343 1134.36,-343 1128.36,-337 1128.36,-331 1128.36,-331 1128.36,-226 1128.36,-226 1128.36,-220 1134.36,-214 1140.36,-214"/>
<text xml:space="preserve" text-anchor="middle" x="1226.36" y="-323.8" font-family="Times New Roman,serif" font-size="16.00">Mobile Client</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_3</title>
<path fill="#eeeeee" stroke="#eeeeee" d="M276.36,-482C276.36,-482 1312.36,-482 1312.36,-482 1318.36,-482 1324.36,-488 1324.36,-494 1324.36,-494 1324.36,-793 1324.36,-793 1324.36,-799 1318.36,-805 1312.36,-805 1312.36,-805 276.36,-805 276.36,-805 270.36,-805 264.36,-799 264.36,-793 264.36,-793 264.36,-494 264.36,-494 264.36,-488 270.36,-482 276.36,-482"/>
<text xml:space="preserve" text-anchor="middle" x="794.36" y="-785.8" font-family="Times New Roman,serif" font-size="16.00">API &amp; Data Ingestion</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_4</title>
<path fill="#eeeeee" stroke="#eeeeee" d="M1572.36,-482C1572.36,-482 1744.36,-482 1744.36,-482 1750.36,-482 1756.36,-488 1756.36,-494 1756.36,-494 1756.36,-793 1756.36,-793 1756.36,-799 1750.36,-805 1744.36,-805 1744.36,-805 1572.36,-805 1572.36,-805 1566.36,-805 1560.36,-799 1560.36,-793 1560.36,-793 1560.36,-494 1560.36,-494 1560.36,-488 1566.36,-482 1572.36,-482"/>
<text xml:space="preserve" text-anchor="middle" x="1658.36" y="-785.8" font-family="Times New Roman,serif" font-size="16.00">Backend Processing</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_5</title>
<path fill="#eeeeee" stroke="#eeeeee" d="M2004.36,-420C2004.36,-420 2176.36,-420 2176.36,-420 2182.36,-420 2188.36,-426 2188.36,-432 2188.36,-432 2188.36,-731 2188.36,-731 2188.36,-737 2182.36,-743 2176.36,-743 2176.36,-743 2004.36,-743 2004.36,-743 1998.36,-743 1992.36,-737 1992.36,-731 1992.36,-731 1992.36,-432 1992.36,-432 1992.36,-426 1998.36,-420 2004.36,-420"/>
<text xml:space="preserve" text-anchor="middle" x="2090.36" y="-723.8" font-family="Times New Roman,serif" font-size="16.00">Storage Layer</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_6</title>
<path fill="#eeeeee" stroke="#eeeeee" d="M2436.36,-420C2436.36,-420 3040.36,-420 3040.36,-420 3046.36,-420 3052.36,-426 3052.36,-432 3052.36,-432 3052.36,-731 3052.36,-731 3052.36,-737 3046.36,-743 3040.36,-743 3040.36,-743 2436.36,-743 2436.36,-743 2430.36,-743 2424.36,-737 2424.36,-731 2424.36,-731 2424.36,-432 2424.36,-432 2424.36,-426 2430.36,-420 2436.36,-420"/>
<text xml:space="preserve" text-anchor="middle" x="2738.36" y="-723.8" font-family="Times New Roman,serif" font-size="16.00">Management &amp; Export</text>
</g>
<!-- User -->
<g id="node1" class="node">
<title>User</title>
<g id="a_node1"><a xlink:title="System User">
<path fill="#e3f2fd" stroke="black" d="M872.36,-245.2C872.36,-245.2 716.36,-245.2 716.36,-245.2 710.36,-245.2 704.36,-239.2 704.36,-233.2 704.36,-233.2 704.36,-170.8 704.36,-170.8 704.36,-164.8 710.36,-158.8 716.36,-158.8 716.36,-158.8 872.36,-158.8 872.36,-158.8 878.36,-158.8 884.36,-164.8 884.36,-170.8 884.36,-170.8 884.36,-233.2 884.36,-233.2 884.36,-239.2 878.36,-245.2 872.36,-245.2"/>
<text xml:space="preserve" text-anchor="middle" x="794.36" y="-197.72" font-family="Arial" font-size="12.00">User</text>
</a>
</g>
</g>
<!-- SmartphoneApp -->
<g id="node4" class="node">
<title>SmartphoneApp</title>
<g id="a_node4"><a xlink:title="ユーザーインターフェースを提供し、ファームウェアとサーバー群を繋ぐ中継ハブ。ユーザー認証、セッション管理、データ中継の役割を担う。">
<path fill="#e8f5e9" stroke="black" d="M1304.36,-308.2C1304.36,-308.2 1148.36,-308.2 1148.36,-308.2 1142.36,-308.2 1136.36,-302.2 1136.36,-296.2 1136.36,-296.2 1136.36,-233.8 1136.36,-233.8 1136.36,-227.8 1142.36,-221.8 1148.36,-221.8 1148.36,-221.8 1304.36,-221.8 1304.36,-221.8 1310.36,-221.8 1316.36,-227.8 1316.36,-233.8 1316.36,-233.8 1316.36,-296.2 1316.36,-296.2 1316.36,-302.2 1310.36,-308.2 1304.36,-308.2"/>
<text xml:space="preserve" text-anchor="middle" x="1226.36" y="-260.73" font-family="Arial" font-size="12.00">Smartphone App</text>
</a>
</g>
</g>
<!-- User&#45;&gt;SmartphoneApp -->
<g id="edge2" class="edge">
<title>User&#45;&gt;SmartphoneApp</title>
<g id="a_edge2"><a xlink:title="Schema: ログイン、実験の作成/選択、セッション開始/終了、イベントファイル選択など">
<path fill="none" stroke="black" d="M884.65,-233.5C884.65,-233.5 1124.66,-233.5 1124.66,-233.5"/>
<polygon fill="black" stroke="black" points="1124.66,-237 1134.66,-233.5 1124.66,-230 1124.66,-237"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="726.03" y="-248" font-family="Arial" font-size="10.00">UI操作</text>
<text xml:space="preserve" text-anchor="middle" x="726.03" y="-236" font-family="Arial" font-size="10.00">ログイン、実験の作成/選択、セッション開始/終了、イベントファイル選択など</text>
</g>
<!-- Firmware_BLE -->
<g id="node2" class="node">
<title>Firmware_BLE</title>
<g id="a_node2"><a xlink:title="Data acquisition firmware">
<path fill="#e3f2fd" stroke="black" d="M872.36,-439.2C872.36,-439.2 716.36,-439.2 716.36,-439.2 710.36,-439.2 704.36,-433.2 704.36,-427.2 704.36,-427.2 704.36,-364.8 704.36,-364.8 704.36,-358.8 710.36,-352.8 716.36,-352.8 716.36,-352.8 872.36,-352.8 872.36,-352.8 878.36,-352.8 884.36,-358.8 884.36,-364.8 884.36,-364.8 884.36,-427.2 884.36,-427.2 884.36,-433.2 878.36,-439.2 872.36,-439.2"/>
<text xml:space="preserve" text-anchor="middle" x="794.36" y="-391.73" font-family="Arial" font-size="12.00">Firmware (BLE)</text>
</a>
</g>
</g>
<!-- Firmware_BLE&#45;&gt;SmartphoneApp -->
<g id="edge1" class="edge">
<title>Firmware_BLE&#45;&gt;SmartphoneApp</title>
<g id="a_edge1"><a xlink:title="Schema: Zstandard圧縮されたバイナリデータ">
<path fill="none" stroke="black" d="M794.36,-352.37C794.36,-322.1 794.36,-287.2 794.36,-287.2 794.36,-287.2 1124.54,-287.2 1124.54,-287.2"/>
<polygon fill="black" stroke="black" points="1124.54,-290.7 1134.54,-287.2 1124.54,-283.7 1124.54,-290.7"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="810.61" y="-277.7" font-family="Arial" font-size="10.00">BLE Notify (Compressed Sensor Data)</text>
<text xml:space="preserve" text-anchor="middle" x="810.61" y="-265.7" font-family="Arial" font-size="10.00">Zstandard圧縮されたバイナリデータ</text>
</g>
<!-- APIServer -->
<g id="node3" class="node">
<title>APIServer</title>
<g id="a_node3"><a xlink:title="Third&#45;party or external APIs (e.g., ERP Detection System)">
<path fill="#e3f2fd" stroke="black" d="M2168.36,-102.2C2168.36,-102.2 2012.36,-102.2 2012.36,-102.2 2006.36,-102.2 2000.36,-96.2 2000.36,-90.2 2000.36,-90.2 2000.36,-27.8 2000.36,-27.8 2000.36,-21.8 2006.36,-15.8 2012.36,-15.8 2012.36,-15.8 2168.36,-15.8 2168.36,-15.8 2174.36,-15.8 2180.36,-21.8 2180.36,-27.8 2180.36,-27.8 2180.36,-90.2 2180.36,-90.2 2180.36,-96.2 2174.36,-102.2 2168.36,-102.2"/>
<text xml:space="preserve" text-anchor="middle" x="2090.36" y="-54.73" font-family="Arial" font-size="12.00">External API</text>
</a>
</g>
</g>
<!-- BIDSExporterService -->
<g id="node14" class="node">
<title>BIDSExporterService</title>
<g id="a_node14"><a xlink:title="指定された実験データをBIDS形式に準拠した形でエクスポートするバッチ処理サービス。">
<path fill="white" stroke="black" d="M2600.36,-514.2C2600.36,-514.2 2444.36,-514.2 2444.36,-514.2 2438.36,-514.2 2432.36,-508.2 2432.36,-502.2 2432.36,-502.2 2432.36,-439.8 2432.36,-439.8 2432.36,-433.8 2438.36,-427.8 2444.36,-427.8 2444.36,-427.8 2600.36,-427.8 2600.36,-427.8 2606.36,-427.8 2612.36,-433.8 2612.36,-439.8 2612.36,-439.8 2612.36,-502.2 2612.36,-502.2 2612.36,-508.2 2606.36,-514.2 2600.36,-514.2"/>
<text xml:space="preserve" text-anchor="middle" x="2522.36" y="-466.73" font-family="Arial" font-size="12.00">BIDS Exporter</text>
</a>
</g>
</g>
<!-- APIServer&#45;&gt;BIDSExporterService -->
<g id="edge6" class="edge">
<title>APIServer&#45;&gt;BIDSExporterService</title>
<g id="a_edge6"><a xlink:title="Schema: { experiment_id }">
<path fill="none" stroke="black" d="M2180.81,-44.6C2315.3,-44.6 2552.36,-44.6 2552.36,-44.6 2552.36,-44.6 2552.36,-415.86 2552.36,-415.86"/>
<polygon fill="black" stroke="black" points="2548.86,-415.86 2552.36,-425.86 2555.86,-415.86 2548.86,-415.86"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="2506.08" y="-35.1" font-family="Arial" font-size="10.00">HTTP POST (JSON)</text>
<text xml:space="preserve" text-anchor="middle" x="2506.08" y="-23.1" font-family="Arial" font-size="10.00">{ experiment_id }</text>
</g>
<!-- CollectorService -->
<g id="node5" class="node">
<title>CollectorService</title>
<g id="a_node5"><a xlink:title="全生データ（センサー、画像、音声）の受信を一手に引き受ける、スケーラブルなAPIゲートウェイ。">
<path fill="white" stroke="black" d="M440.36,-604.2C440.36,-604.2 284.36,-604.2 284.36,-604.2 278.36,-604.2 272.36,-598.2 272.36,-592.2 272.36,-592.2 272.36,-529.8 272.36,-529.8 272.36,-523.8 278.36,-517.8 284.36,-517.8 284.36,-517.8 440.36,-517.8 440.36,-517.8 446.36,-517.8 452.36,-523.8 452.36,-529.8 452.36,-529.8 452.36,-592.2 452.36,-592.2 452.36,-598.2 446.36,-604.2 440.36,-604.2"/>
<text xml:space="preserve" text-anchor="middle" x="362.36" y="-556.73" font-family="Arial" font-size="12.00">Collector Service</text>
</a>
</g>
</g>
<!-- SmartphoneApp&#45;&gt;CollectorService -->
<g id="edge3" class="edge">
<title>SmartphoneApp&#45;&gt;CollectorService</title>
<g id="a_edge3"><a xlink:title="Schema: エンドポイント `/api/v1/media`: フォームパートにメディアファイルとメタデータ { user_id, session_id }">
<path fill="none" stroke="black" d="M1135.93,-266.2C914.37,-266.2 362.36,-266.2 362.36,-266.2 362.36,-266.2 362.36,-505.99 362.36,-505.99"/>
<polygon fill="black" stroke="black" points="358.86,-505.99 362.36,-515.99 365.86,-505.99 358.86,-505.99"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="314.62" y="-280.7" font-family="Arial" font-size="10.00">HTTP POST (Multipart/form&#45;data)</text>
<text xml:space="preserve" text-anchor="middle" x="314.62" y="-268.7" font-family="Arial" font-size="10.00">エンドポイント `/api/v1/media`: フォームパートにメディアファイルとメタデータ { user_id, session_id }</text>
</g>
<!-- RealtimeAnalyzerService -->
<g id="node10" class="node">
<title>RealtimeAnalyzerService</title>
<g id="a_node10"><a xlink:title="生データをリアルタイムに解析し、結果をAPI経由で提供するサービス。">
<path fill="white" stroke="black" d="M1736.36,-770.2C1736.36,-770.2 1580.36,-770.2 1580.36,-770.2 1574.36,-770.2 1568.36,-764.2 1568.36,-758.2 1568.36,-758.2 1568.36,-695.8 1568.36,-695.8 1568.36,-689.8 1574.36,-683.8 1580.36,-683.8 1580.36,-683.8 1736.36,-683.8 1736.36,-683.8 1742.36,-683.8 1748.36,-689.8 1748.36,-695.8 1748.36,-695.8 1748.36,-758.2 1748.36,-758.2 1748.36,-764.2 1742.36,-770.2 1736.36,-770.2"/>
<text xml:space="preserve" text-anchor="middle" x="1658.36" y="-722.73" font-family="Arial" font-size="12.00">Realtime Analyzer</text>
</a>
</g>
</g>
<!-- SmartphoneApp&#45;&gt;RealtimeAnalyzerService -->
<g id="edge5" class="edge">
<title>SmartphoneApp&#45;&gt;RealtimeAnalyzerService</title>
<g id="a_edge5"><a xlink:title="Schema: 自身のユーザーIDに紐づく解析結果の要求">
<path fill="none" stroke="black" d="M1316.67,-286.6C1359.04,-286.6 1400.36,-286.6 1400.36,-286.6 1400.36,-286.6 1400.36,-727 1400.36,-727 1400.36,-727 1556.61,-727 1556.61,-727"/>
<polygon fill="black" stroke="black" points="1556.61,-730.5 1566.61,-727 1556.61,-723.5 1556.61,-730.5"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="1547.36" y="-533.58" font-family="Arial" font-size="10.00">HTTP GET (JSON)</text>
<text xml:space="preserve" text-anchor="middle" x="1547.36" y="-521.58" font-family="Arial" font-size="10.00">自身のユーザーIDに紐づく解析結果の要求</text>
</g>
<!-- SessionManagerService -->
<g id="node13" class="node">
<title>SessionManagerService</title>
<g id="a_node13"><a xlink:title="実験とセッションのメタデータ、およびERPタスク等のイベントデータを管理し、ライフサイクルを司るサービス。">
<path fill="white" stroke="black" d="M2600.36,-708.2C2600.36,-708.2 2444.36,-708.2 2444.36,-708.2 2438.36,-708.2 2432.36,-702.2 2432.36,-696.2 2432.36,-696.2 2432.36,-633.8 2432.36,-633.8 2432.36,-627.8 2438.36,-621.8 2444.36,-621.8 2444.36,-621.8 2600.36,-621.8 2600.36,-621.8 2606.36,-621.8 2612.36,-627.8 2612.36,-633.8 2612.36,-633.8 2612.36,-696.2 2612.36,-696.2 2612.36,-702.2 2606.36,-708.2 2600.36,-708.2"/>
<text xml:space="preserve" text-anchor="middle" x="2522.36" y="-660.73" font-family="Arial" font-size="12.00">Session Manager</text>
</a>
</g>
</g>
<!-- SmartphoneApp&#45;&gt;SessionManagerService -->
<g id="edge4" class="edge">
<title>SmartphoneApp&#45;&gt;SessionManagerService</title>
<g id="a_edge4"><a xlink:title="Schema: セッション終了通知。JSONパートにセッションメタデータ、ファイルパートにイベントリスト(CSV)を含む。">
<path fill="none" stroke="black" d="M1316.66,-243.4C1569.19,-243.4 2264.36,-243.4 2264.36,-243.4 2264.36,-243.4 2264.36,-639.08 2264.36,-639.08 2264.36,-639.08 2420.61,-639.08 2420.61,-639.08"/>
<polygon fill="black" stroke="black" points="2420.61,-642.58 2430.61,-639.08 2420.61,-635.58 2420.61,-642.58"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="1692.97" y="-233.9" font-family="Arial" font-size="10.00">HTTP POST (Multipart/form&#45;data)</text>
<text xml:space="preserve" text-anchor="middle" x="1692.97" y="-221.9" font-family="Arial" font-size="10.00">セッション終了通知。JSONパートにセッションメタデータ、ファイルパートにイベントリスト(CSV)を含む。</text>
</g>
<!-- RawDataExchange -->
<g id="node6" class="node">
<title>RawDataExchange</title>
<g id="a_node6"><a xlink:title="Fanout exchange for data distribution">
<path fill="#fff3cd" stroke="black" d="M872.36,-633.2C872.36,-633.2 716.36,-633.2 716.36,-633.2 710.36,-633.2 704.36,-627.2 704.36,-621.2 704.36,-621.2 704.36,-558.8 704.36,-558.8 704.36,-552.8 710.36,-546.8 716.36,-546.8 716.36,-546.8 872.36,-546.8 872.36,-546.8 878.36,-546.8 884.36,-552.8 884.36,-558.8 884.36,-558.8 884.36,-621.2 884.36,-621.2 884.36,-627.2 878.36,-633.2 872.36,-633.2"/>
<text xml:space="preserve" text-anchor="middle" x="794.36" y="-592.85" font-family="Arial" font-size="12.00">RabbitMQ Exchange</text>
<text xml:space="preserve" text-anchor="middle" x="794.36" y="-578.6" font-family="Arial" font-size="12.00">(raw_data_exchange)</text>
</a>
</g>
</g>
<!-- CollectorService&#45;&gt;RawDataExchange -->
<g id="edge10" class="edge">
<title>CollectorService&#45;&gt;RawDataExchange</title>
<g id="a_edge10"><a xlink:title="Schema: Body: バイナリデータ, Headers: { user_id }">
<path fill="none" stroke="black" d="M452.65,-575.5C452.65,-575.5 692.66,-575.5 692.66,-575.5"/>
<polygon fill="black" stroke="black" points="692.66,-579 702.66,-575.5 692.66,-572 692.66,-579"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="688.16" y="-566" font-family="Arial" font-size="10.00">AMQP Message</text>
<text xml:space="preserve" text-anchor="middle" x="688.16" y="-554" font-family="Arial" font-size="10.00">Body: バイナリデータ, Headers: { user_id }</text>
</g>
<!-- ProcessingQueue -->
<g id="node7" class="node">
<title>ProcessingQueue</title>
<g id="a_node7"><a xlink:title="Queue for data persistence tasks">
<path fill="#fff3cd" stroke="black" d="M1304.36,-576.2C1304.36,-576.2 1148.36,-576.2 1148.36,-576.2 1142.36,-576.2 1136.36,-570.2 1136.36,-564.2 1136.36,-564.2 1136.36,-501.8 1136.36,-501.8 1136.36,-495.8 1142.36,-489.8 1148.36,-489.8 1148.36,-489.8 1304.36,-489.8 1304.36,-489.8 1310.36,-489.8 1316.36,-495.8 1316.36,-501.8 1316.36,-501.8 1316.36,-564.2 1316.36,-564.2 1316.36,-570.2 1310.36,-576.2 1304.36,-576.2"/>
<text xml:space="preserve" text-anchor="middle" x="1226.36" y="-528.73" font-family="Arial" font-size="12.00">Processing Queue</text>
</a>
</g>
</g>
<!-- RawDataExchange&#45;&gt;ProcessingQueue -->
<g id="edge17" class="edge">
<title>RawDataExchange&#45;&gt;ProcessingQueue</title>
<g id="a_edge17"><a xlink:title="Fanout distribution">
<path fill="none" stroke="black" d="M884.65,-561.5C884.65,-561.5 1124.66,-561.5 1124.66,-561.5"/>
<polygon fill="black" stroke="black" points="1124.66,-565 1134.66,-561.5 1124.66,-558 1124.66,-565"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="968.66" y="-552" font-family="Arial" font-size="10.00">AMQP Message</text>
</g>
<!-- AnalysisQueue -->
<g id="node8" class="node">
<title>AnalysisQueue</title>
<g id="a_node8"><a xlink:title="Queue for real&#45;time analysis tasks">
<path fill="#fff3cd" stroke="black" d="M1304.36,-770.2C1304.36,-770.2 1148.36,-770.2 1148.36,-770.2 1142.36,-770.2 1136.36,-764.2 1136.36,-758.2 1136.36,-758.2 1136.36,-695.8 1136.36,-695.8 1136.36,-689.8 1142.36,-683.8 1148.36,-683.8 1148.36,-683.8 1304.36,-683.8 1304.36,-683.8 1310.36,-683.8 1316.36,-689.8 1316.36,-695.8 1316.36,-695.8 1316.36,-758.2 1316.36,-758.2 1316.36,-764.2 1310.36,-770.2 1304.36,-770.2"/>
<text xml:space="preserve" text-anchor="middle" x="1226.36" y="-722.73" font-family="Arial" font-size="12.00">Analysis Queue</text>
</a>
</g>
</g>
<!-- RawDataExchange&#45;&gt;AnalysisQueue -->
<g id="edge18" class="edge">
<title>RawDataExchange&#45;&gt;AnalysisQueue</title>
<g id="a_edge18"><a xlink:title="Fanout distribution">
<path fill="none" stroke="black" d="M884.65,-625.6C1011.3,-625.6 1226.36,-625.6 1226.36,-625.6 1226.36,-625.6 1226.36,-671.9 1226.36,-671.9"/>
<polygon fill="black" stroke="black" points="1222.86,-671.9 1226.36,-681.9 1229.86,-671.9 1222.86,-671.9"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="1042.65" y="-616.1" font-family="Arial" font-size="10.00">AMQP Message</text>
</g>
<!-- ProcessorService -->
<g id="node9" class="node">
<title>ProcessorService</title>
<g id="a_node9"><a xlink:title="生データを解凍・整形し、オブジェクトストレージとデータベースに永続化するバックエンドサービス。">
<path fill="white" stroke="black" d="M1736.36,-576.2C1736.36,-576.2 1580.36,-576.2 1580.36,-576.2 1574.36,-576.2 1568.36,-570.2 1568.36,-564.2 1568.36,-564.2 1568.36,-501.8 1568.36,-501.8 1568.36,-495.8 1574.36,-489.8 1580.36,-489.8 1580.36,-489.8 1736.36,-489.8 1736.36,-489.8 1742.36,-489.8 1748.36,-495.8 1748.36,-501.8 1748.36,-501.8 1748.36,-564.2 1748.36,-564.2 1748.36,-570.2 1742.36,-576.2 1736.36,-576.2"/>
<text xml:space="preserve" text-anchor="middle" x="1658.36" y="-528.73" font-family="Arial" font-size="12.00">Processor Service</text>
</a>
</g>
</g>
<!-- ProcessingQueue&#45;&gt;ProcessorService -->
<g id="edge16" class="edge">
<title>ProcessingQueue&#45;&gt;ProcessorService</title>
<g id="a_edge16"><a xlink:title="Schema: Body: 時刻同期オフセット情報, Headers: { user_id }">
<path fill="none" stroke="black" d="M1316.65,-533C1316.65,-533 1556.66,-533 1556.66,-533"/>
<polygon fill="black" stroke="black" points="1556.66,-536.5 1566.66,-533 1556.66,-529.5 1556.66,-536.5"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="1583.66" y="-547.5" font-family="Arial" font-size="10.00">AMQP Message</text>
<text xml:space="preserve" text-anchor="middle" x="1583.66" y="-535.5" font-family="Arial" font-size="10.00">Body: 時刻同期オフセット情報, Headers: { user_id }</text>
</g>
<!-- AnalysisQueue&#45;&gt;RealtimeAnalyzerService -->
<g id="edge19" class="edge">
<title>AnalysisQueue&#45;&gt;RealtimeAnalyzerService</title>
<g id="a_edge19"><a xlink:title="Schema: Body: バイナリデータ, Headers: { user_id }">
<path fill="none" stroke="black" d="M1316.65,-748.6C1316.65,-748.6 1556.66,-748.6 1556.66,-748.6"/>
<polygon fill="black" stroke="black" points="1556.66,-752.1 1566.66,-748.6 1556.66,-745.1 1556.66,-752.1"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="1552.16" y="-763.1" font-family="Arial" font-size="10.00">AMQP Message</text>
<text xml:space="preserve" text-anchor="middle" x="1552.16" y="-751.1" font-family="Arial" font-size="10.00">Body: バイナリデータ, Headers: { user_id }</text>
</g>
<!-- MinIO -->
<g id="node11" class="node">
<title>MinIO</title>
<g id="a_node11"><a xlink:title="全ての生データ（EEG/IMU, 画像, 音声など）を格納する、スケーラブルなストレージ基盤。">
<path fill="#f8d7da" stroke="black" d="M2168.36,-514.2C2168.36,-514.2 2012.36,-514.2 2012.36,-514.2 2006.36,-514.2 2000.36,-508.2 2000.36,-502.2 2000.36,-502.2 2000.36,-439.8 2000.36,-439.8 2000.36,-433.8 2006.36,-427.8 2012.36,-427.8 2012.36,-427.8 2168.36,-427.8 2168.36,-427.8 2174.36,-427.8 2180.36,-433.8 2180.36,-439.8 2180.36,-439.8 2180.36,-502.2 2180.36,-502.2 2180.36,-508.2 2174.36,-514.2 2168.36,-514.2"/>
<text xml:space="preserve" text-anchor="middle" x="2090.36" y="-473.85" font-family="Arial" font-size="12.00">MinIO</text>
<text xml:space="preserve" text-anchor="middle" x="2090.36" y="-459.6" font-family="Arial" font-size="12.00">(Object Storage)</text>
</a>
</g>
</g>
<!-- ProcessorService&#45;&gt;MinIO -->
<g id="edge11" class="edge">
<title>ProcessorService&#45;&gt;MinIO</title>
<g id="a_edge11"><a xlink:title="Schema: EEG/IMUデータ, JPEG, WAVなど">
<path fill="none" stroke="black" d="M1748.65,-502C1748.65,-502 1988.66,-502 1988.66,-502"/>
<polygon fill="black" stroke="black" points="1988.66,-505.5 1998.66,-502 1988.66,-498.5 1988.66,-505.5"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="1961.28" y="-516.5" font-family="Arial" font-size="10.00">Zstandard圧縮されたバイナリ</text>
<text xml:space="preserve" text-anchor="middle" x="1961.28" y="-504.5" font-family="Arial" font-size="10.00">EEG/IMUデータ, JPEG, WAVなど</text>
</g>
<!-- PostgreSQL -->
<g id="node12" class="node">
<title>PostgreSQL</title>
<g id="a_node12"><a xlink:title="全てのメタデータを管理する、信頼性の高いリレーショナルデータベース。">
<path fill="#f8d7da" stroke="black" d="M2168.36,-708.2C2168.36,-708.2 2012.36,-708.2 2012.36,-708.2 2006.36,-708.2 2000.36,-702.2 2000.36,-696.2 2000.36,-696.2 2000.36,-633.8 2000.36,-633.8 2000.36,-627.8 2006.36,-621.8 2012.36,-621.8 2012.36,-621.8 2168.36,-621.8 2168.36,-621.8 2174.36,-621.8 2180.36,-627.8 2180.36,-633.8 2180.36,-633.8 2180.36,-696.2 2180.36,-696.2 2180.36,-702.2 2174.36,-708.2 2168.36,-708.2"/>
<text xml:space="preserve" text-anchor="middle" x="2090.36" y="-667.85" font-family="Arial" font-size="12.00">PostgreSQL</text>
<text xml:space="preserve" text-anchor="middle" x="2090.36" y="-653.6" font-family="Arial" font-size="12.00">(Metadata DB)</text>
</a>
</g>
</g>
<!-- ProcessorService&#45;&gt;PostgreSQL -->
<g id="edge12" class="edge">
<title>ProcessorService&#45;&gt;PostgreSQL</title>
<g id="a_edge12"><a xlink:title="Schema: 生データオブジェクトのメタ情報 (`raw_data_objects`テーブル)">
<path fill="none" stroke="black" d="M1658.36,-576.69C1658.36,-602.19 1658.36,-629.4 1658.36,-629.4 1658.36,-629.4 1988.54,-629.4 1988.54,-629.4"/>
<polygon fill="black" stroke="black" points="1988.54,-632.9 1998.54,-629.4 1988.54,-625.9 1988.54,-632.9"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="1601.72" y="-619.9" font-family="Arial" font-size="10.00">SQL INSERT</text>
<text xml:space="preserve" text-anchor="middle" x="1601.72" y="-607.9" font-family="Arial" font-size="10.00">生データオブジェクトのメタ情報 (`raw_data_objects`テーブル)</text>
</g>
<!-- RealtimeAnalyzerService&#45;&gt;SmartphoneApp -->
<g id="edge20" class="edge">
<title>RealtimeAnalyzerService&#45;&gt;SmartphoneApp</title>
<g id="a_edge20"><a xlink:title="Schema: { psd_image_b64, coherence_image_b64, timestamp }">
<path fill="none" stroke="black" d="M1568.04,-705.4C1525.67,-705.4 1484.36,-705.4 1484.36,-705.4 1484.36,-705.4 1484.36,-265 1484.36,-265 1484.36,-265 1328.11,-265 1328.11,-265"/>
<polygon fill="black" stroke="black" points="1328.11,-261.5 1318.11,-265 1328.11,-268.5 1328.11,-261.5"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="1366.61" y="-439.42" font-family="Arial" font-size="10.00">HTTP GET (JSON)</text>
<text xml:space="preserve" text-anchor="middle" x="1366.61" y="-427.42" font-family="Arial" font-size="10.00">{ psd_image_b64, coherence_image_b64, timestamp }</text>
</g>
<!-- MinIO&#45;&gt;BIDSExporterService -->
<g id="edge8" class="edge">
<title>MinIO&#45;&gt;BIDSExporterService</title>
<g id="a_edge8"><a xlink:title="Schema: セッションに対応する生データオブジェクト群">
<path fill="none" stroke="black" d="M2180.65,-456.6C2180.65,-456.6 2420.66,-456.6 2420.66,-456.6"/>
<polygon fill="black" stroke="black" points="2420.66,-460.1 2430.66,-456.6 2420.66,-453.1 2420.66,-460.1"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="2135.28" y="-470.35" font-family="Arial" font-size="10.00">Object GET</text>
<text xml:space="preserve" text-anchor="middle" x="2135.28" y="-458.35" font-family="Arial" font-size="10.00">セッションに対応する生データオブジェクト群</text>
</g>
<!-- PostgreSQL&#45;&gt;SessionManagerService -->
<g id="edge15" class="edge">
<title>PostgreSQL&#45;&gt;SessionManagerService</title>
<g id="a_edge15"><a xlink:title="Schema: 各種メタデータの読み出し">
<path fill="none" stroke="black" d="M2180.65,-690.92C2180.65,-690.92 2420.66,-690.92 2420.66,-690.92"/>
<polygon fill="black" stroke="black" points="2420.66,-694.42 2430.66,-690.92 2420.66,-687.42 2420.66,-694.42"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="2395.16" y="-704.67" font-family="Arial" font-size="10.00">SQL SELECT</text>
<text xml:space="preserve" text-anchor="middle" x="2395.16" y="-692.67" font-family="Arial" font-size="10.00">各種メタデータの読み出し</text>
</g>
<!-- PostgreSQL&#45;&gt;BIDSExporterService -->
<g id="edge7" class="edge">
<title>PostgreSQL&#45;&gt;BIDSExporterService</title>
<g id="a_edge7"><a xlink:title="Schema: 指定された`experiment_id`に属する全てのセッションメタデータ">
<path fill="none" stroke="black" d="M2180.59,-656.36C2254.99,-656.36 2348.36,-656.36 2348.36,-656.36 2348.36,-656.36 2348.36,-485.4 2348.36,-485.4 2348.36,-485.4 2420.53,-485.4 2420.53,-485.4"/>
<polygon fill="black" stroke="black" points="2420.53,-488.9 2430.53,-485.4 2420.53,-481.9 2420.53,-488.9"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="2141.73" y="-609.18" font-family="Arial" font-size="10.00">SQL SELECT</text>
<text xml:space="preserve" text-anchor="middle" x="2141.73" y="-597.18" font-family="Arial" font-size="10.00">指定された`experiment_id`に属する全てのセッションメタデータ</text>
</g>
<!-- SessionManagerService&#45;&gt;PostgreSQL -->
<g id="edge14" class="edge">
<title>SessionManagerService&#45;&gt;PostgreSQL</title>
<g id="a_edge14"><a xlink:title="Schema: 実験、セッション情報">
<path fill="none" stroke="black" d="M2432.06,-673.64C2432.06,-673.64 2192.05,-673.64 2192.05,-673.64"/>
<polygon fill="black" stroke="black" points="2192.05,-670.14 2182.05,-673.64 2192.05,-677.14 2192.05,-670.14"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="2233.3" y="-664.14" font-family="Arial" font-size="10.00">SQL INSERT/UPDATE</text>
<text xml:space="preserve" text-anchor="middle" x="2233.3" y="-652.14" font-family="Arial" font-size="10.00">実験、セッション情報</text>
</g>
<!-- DataLinkageWorker -->
<g id="node15" class="node">
<title>DataLinkageWorker</title>
<g id="a_node15"><a xlink:title="Asynchronous worker for data linkage">
<path fill="#fff3cd" stroke="black" d="M3032.36,-708.2C3032.36,-708.2 2876.36,-708.2 2876.36,-708.2 2870.36,-708.2 2864.36,-702.2 2864.36,-696.2 2864.36,-696.2 2864.36,-633.8 2864.36,-633.8 2864.36,-627.8 2870.36,-621.8 2876.36,-621.8 2876.36,-621.8 3032.36,-621.8 3032.36,-621.8 3038.36,-621.8 3044.36,-627.8 3044.36,-633.8 3044.36,-633.8 3044.36,-696.2 3044.36,-696.2 3044.36,-702.2 3038.36,-708.2 3032.36,-708.2"/>
<text xml:space="preserve" text-anchor="middle" x="2954.36" y="-667.85" font-family="Arial" font-size="12.00">Async Task Queue</text>
<text xml:space="preserve" text-anchor="middle" x="2954.36" y="-653.6" font-family="Arial" font-size="12.00">(DataLinker)</text>
</a>
</g>
</g>
<!-- SessionManagerService&#45;&gt;DataLinkageWorker -->
<g id="edge21" class="edge">
<title>SessionManagerService&#45;&gt;DataLinkageWorker</title>
<g id="a_edge21"><a xlink:title="Schema: データ紐付け処理のタスク">
<path fill="none" stroke="black" d="M2612.65,-665C2612.65,-665 2852.66,-665 2852.66,-665"/>
<polygon fill="black" stroke="black" points="2852.66,-668.5 2862.66,-665 2852.66,-661.5 2852.66,-668.5"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="2827.16" y="-655.5" font-family="Arial" font-size="10.00">Job</text>
<text xml:space="preserve" text-anchor="middle" x="2827.16" y="-643.5" font-family="Arial" font-size="10.00">データ紐付け処理のタスク</text>
</g>
<!-- BIDSExporterService&#45;&gt;APIServer -->
<g id="edge9" class="edge">
<title>BIDSExporterService&#45;&gt;APIServer</title>
<g id="a_edge9"><a xlink:title="Schema: BIDS形式のディレクトリ構造を持つデータセット">
<path fill="none" stroke="black" d="M2492.36,-427.31C2492.36,-324.03 2492.36,-73.4 2492.36,-73.4 2492.36,-73.4 2192.34,-73.4 2192.34,-73.4"/>
<polygon fill="black" stroke="black" points="2192.34,-69.9 2182.34,-73.4 2192.34,-76.9 2192.34,-69.9"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="2661.86" y="-90.85" font-family="Arial" font-size="10.00">BIDS</text>
<text xml:space="preserve" text-anchor="middle" x="2661.86" y="-78.85" font-family="Arial" font-size="10.00">BIDS形式のディレクトリ構造を持つデータセット</text>
</g>
<!-- DataLinkageWorker&#45;&gt;PostgreSQL -->
<g id="edge13" class="edge">
<title>DataLinkageWorker&#45;&gt;PostgreSQL</title>
<g id="a_edge13"><a xlink:title="Schema: セッションとオブジェクトIDの関連付け">
<path fill="none" stroke="black" d="M2954.36,-621.34C2954.36,-609.07 2954.36,-599 2954.36,-599 2954.36,-599 2090.36,-599 2090.36,-599 2090.36,-599 2090.36,-609.83 2090.36,-609.83"/>
<polygon fill="black" stroke="black" points="2086.86,-609.83 2090.36,-619.83 2093.86,-609.83 2086.86,-609.83"/>
</a>
</g>
<text xml:space="preserve" text-anchor="middle" x="2667.24" y="-589.5" font-family="Arial" font-size="10.00">SQL UPDATE</text>
<text xml:space="preserve" text-anchor="middle" x="2667.24" y="-577.5" font-family="Arial" font-size="10.00">セッションとオブジェクトIDの関連付け</text>
</g>
</g>
</svg>
